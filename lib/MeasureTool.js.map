{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 4d014cc9469574388cbd","webpack:///./src/index.js","webpack:///./src/context-menu.js"],"names":["MeasureTool","map","_map","_init","_contextMenu","getDiv","_startNode","addItem","_startMeasure","_endNode","_endMeasure","_overlay","google","maps","OverlayView","onAdd","_projection","getProjection","draw","setMap","_bindToggleContextMenu","addListener","_firstPoint","mouseEvent","latLng","show","fromLatLngToContainerPixel","document","addEventListener","event","which","hide","clientX","left","width","clientY","top","height","console","log","toggleItems","ContextMenu","_containerDiv","getBoundingClientRect","div","createElement","oncontextmenu","preventDefault","_list","appendChild","_isVisible","name","isVisible","cb","context","item","content","createTextNode","onclick","e","apply","showItem","hideItem","style","cssText","itemsToShow","itemsToHide","forEach","point","y","x"],"mappings":"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","file":"MeasureTool.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"MeasureTool\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MeasureTool\"] = factory();\n\telse\n\t\troot[\"MeasureTool\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4d014cc9469574388cbd","import ContextMenu from './context-menu';\n\nexport default class MeasureTool {\n  constructor(map) {\n    this._map = map;\n    this._init();\n  }\n\n  _init() {\n    this._contextMenu = new ContextMenu(this._map.getDiv());\n    this._startNode = this._contextMenu.addItem(\"Measure distance\", true, this._startMeasure, this);\n    this._endNode = this._contextMenu.addItem(\"Clear measurement\", false, this._endMeasure, this);\n\n    this._overlay = new google.maps.OverlayView();\n    this._overlay.onAdd = () => {\n      this._projection = this._overlay.getProjection();\n    };\n    this._overlay.draw = () => {};\n    this._overlay.setMap(this._map);\n    this._bindToggleContextMenu();\n  }\n\n  _bindToggleContextMenu() {\n    this._map.addListener('rightclick', mouseEvent => {\n      this._firstPoint = mouseEvent.latLng;\n      this._contextMenu.show(this._projection.fromLatLngToContainerPixel(mouseEvent.latLng));\n    });\n\n    document.addEventListener('keydown', event => {\n      if (event.which === 27) {\n        this._contextMenu.hide();\n      }\n    });\n    this._map.getDiv().addEventListener('mousedown', event => {\n      if (event.clientX >= this._contextMenu.left &&\n          event.clientX <= this._contextMenu.left + this._contextMenu.width &&\n          event.clientY >= this._contextMenu.top &&\n          event.clientY <= this._contextMenu.top + this._contextMenu.height) {\n        return;\n      }\n      this._contextMenu.hide();\n    });\n  }\n\n  _startMeasure() {\n    console.log(\"start measure\", this._firstPoint);\n    this._contextMenu.toggleItems([this._endNode], [this._startNode]);\n  }\n\n  _endMeasure() {\n    console.log(\"end measure\");\n    this._contextMenu.toggleItems([this._startNode], [this._endNode]);\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default class ContextMenu {\n\n  get left() { return this._containerDiv.getBoundingClientRect().left; }\n  get top() { return this._containerDiv.getBoundingClientRect().top; }\n  get width() { return this._containerDiv.getBoundingClientRect().width; }\n  get height() { return this._containerDiv.getBoundingClientRect().height; }\n\n  constructor(div) {\n    this._containerDiv = document.createElement(\"div\");\n    this._containerDiv.oncontextmenu = event => event.preventDefault();\n    this._list = document.createElement(\"ul\");\n    this._containerDiv.appendChild(this._list);\n    div.appendChild(this._containerDiv);\n    this._isVisible = false;\n  }\n\n  addItem(name, isVisible, cb, context = this) {\n    let item = document.createElement(\"li\");\n    let content = document.createTextNode(name);\n\n    item.appendChild(content);\n    item.onclick = (e) => {\n      e.preventDefault();\n      cb.apply(context);\n      this.hide();\n    };\n    if (isVisible) {\n      this.showItem(item);\n    } else {\n      this.hideItem(item);\n    }\n    this._list.appendChild(item);\n    return item;\n  }\n\n  hideItem(item) {\n    item.style.cssText = `display: none`;\n  }\n\n  showItem(item) {\n    item.style.cssText = `display: block`;\n  }\n\n  toggleItems(itemsToShow, itemsToHide) {\n    itemsToShow.forEach(item => this.showItem(item));\n    itemsToHide.forEach(item => this.hideItem(item));\n  }\n\n  show(point) {\n    this._isVisible = true;\n    this._containerDiv.style.cssText = `\n      display: block;\n      position: absolute; \n      top: ${point.y}px; \n      left: ${point.x}px;\n    `;\n  }\n\n  hide() {\n    this._isVisible = false;\n    this._containerDiv.style.cssText = `display: none`;\n  }\n\n  toggle(point) {\n    if (this._isVisible) {\n      this.hide();\n    } else {\n      this.show(point);\n    }\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/context-menu.js"],"sourceRoot":""}